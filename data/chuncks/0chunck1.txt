Automotive Ethernet Bus Besides a Client ECU is being compromised by an MITM Attacker Gehrmann et al 5 addressed specic problems and op portunities for intrusion detection in SOMEIP as well as suggested an architecture for a SOMEIP intrusion detection scheme and discussed its security features Iorio et al 6 7 proposed a novel architecture to enhance the security of evolving SOMEIP middleware Li at al 16 developed Ori a Greybox Fuzzer that can efciently detect breaches in SOMEIP applications Lauser et al 9 have discussed how formal models can be used to verify the security of protocols used in modern vehicles Rumez et al 8 explained various security countermeasures in the elds of rewalls intrusion detection systems IDSs and identity and access management Herold et al 3 proposed a rulebased IDS for SOMEIP protocol To the best of our knowledge none of the previous works have applied deep learningbased sequential models for intru sion detection on SOMEIP protocol That is a main contribu tion of this work in addition to the generation of the labeled dataset with multiple classes of intrusions and a normal class III O VERVIEW OF SOMEIP AMiddleware refers to a connective tissue between different software applications In other words it handles all functions that are needed for a service to allow data exchange between several ECUs 21 Due to the growing amount of software 17 in automobiles as well as the spread of functions within their invehicle network and the deployment of a variety of software architectures and operating systems inside vehicles the implementation of a middleware software within invehicle networks is essential in bridging the gap between them Hence after being proposed by the BMW Group in 2011 and standardized by AUTOSAR SOMEIP was chosen as the standard middleware for IPbased service oriented communication in cars The middleware SOMEIP runs at top levels of the OSI model 5 The structure of its header layout is as shown in Figure 1 Some of the elds presented in the header of the SOMEIP packet willFig 3 Attacks on SOMEIP protocol be considered in our work as the input features for the deep learning based IDS Table IV A SOMEIP Remote Procedure Calls Since SOMEIP is a servicebased communication ap proach it allows the exchange of different types of remote procedure calls In general a remote procedure call RPC is an interprocess communication technique that is used for client server based applications 15 In this current work we have considered three main types of SOMEIP RPC RequestResponse a method with Request and Response messages The Request is a message sent by the client when it invokes a method The Response is a message sent from the server to the client that contains the method invocations outcome Fire and Forget a procedure that only uses Request messages As in the RequestResponse scenario the client calls a server method However unlike in the RequestResponse instance the client does not anticipate a response Events In this method the server sends messages to the client with particular information either periodically or whenever there is a change event The server expects no response from the client TABLE I TRAINING AND TESTING DATASET CLASSES Class Training Dataset Testing Dataset Normal 2533 2471 Error on Error 39 54 Error on Event 60 54 Missing Response 92 81 Missing Request 83 111 Total 2807 2771 IV G ENERATING LABELED DATASET A Dataset Generation 1 SOMEIP packet generator In order to generate SOMEIP libpcap dump les we have used the SOMEIP Generator developed by 3 implemented in Python 3 and available in Github 4 The generator models the behavior ofdifferent clients and servers assumed to behave according to the AUTOSAR standard specication as well as an attacker carrying out a variety of attacks depicted in Figure 3 and described in section IVA3 As seen in Figure 4 and Table II we have tuned the different parameters for generating different attack scenarios such as the network architecture conguration depicted in Figure 2 the SOMEIP services to be exchanged and the attack to be implemented along with its frequency of execution For training and testing our deep learning based IDS we have generated several pcap les corresponding to different attack types concatenated them and processed them as described in section IVA4 The distributions of both datasets are shown in Table I and their corresponding features are described in Table IV The training dataset comprises about 274 attacks is 132 MB in size and contains 2807 packets Regarding the testing dataset it contains around 300 attacks has a size of 130 MB and composed of 2771 packets Readers can get our SOMEIP intrusion dataset by referring to 24 Fig 4 Dataset Generation 2 Dataset Imbalance As seen in table I the distribution of samples across the different classes is biased In fact the attack classes frequency is highly imbalanced ie there is a bias or skewness towards the majority class Normal class present in the target It is reasonable to have such a skewed datasetTABLE II TUNED PARAMETERS FOR DATASET GENERATION REPRESENTS FIRST STEP IN FIGURE 4 Parameters to congure Description Chosen Value DevicesContains information like name type mac ip 8 Servers 8 Clients and sender port and receiving port of each Client Server and Attacker 1 Attacker Services Contains information about offered and requested services 3 Services Number of packets to generate per Client Method and Service Denes the number of packets generated per client 50 Number of attacks to execute Denes the rate an attack will be performed 10 Minimum Response Time of Attacker Denes the minimum response time of the attacker in ms 1 Maximum Response Time of Attacker Denes the maximum response time of the attacker in ms 3 Implemented AttackError On Error Denes which attacks can be used Error On Event Missing Request Missing Response Output File Location Describes the location where to store the resulting pcap outputpcap since it represents an anomaly problem However we do not aim changing the nature of the data and make it balanced even though this problem poses a challenge for predictive modeling as most of the supervised deep learning algorithms used