less than 05 020004000600080001000012000 0153045 1 4 16 64 256 1024 Requests per Second CPU Payload size bytes Vanilla vsomeip Nosec levelAuthentication level Condentiality level a 020004000600080001000012000 0255075 1 4 16 64 256 1024 Requests per Second CPU Payload size bytes Vanilla vsomeip Nosec levelAuthentication level Condentiality level b Fig 7 Served requests per second and CPU usage comparison between vanilla vsomeip and the securityenhanced version both in case of a local and b remote communication to the better exploitation of the available parallelism by interleaving the different steps of the process Second the outcome of the benchmarks assessing the run time protection is presented Talking about transport protocols denitely similar results have been obtained both with UDP and TCP for the sake of brevity only the plots about the former are presented in the following Considering the RTT benchmarks shown in Figs 6a and 6b different conclusions can be drawn depending on whether the messages need to be transmitted to a remote host or not While in case of local communication in fact the security functionalities introduce additional latency accounting for about one third of the total RTT the overhead becomes almost negligible if packets ow across Ethernet given the predominance of the physical communication overheads Comparing vanilla vsomeip withthe PoC operating at nosec level the latter appears to be associated with slightly worse performance Albeit executing the same operations variations may be ascribed to some implementation artifacts required by the PoC as well as to experimental deviations due to the Linux scheduler As for the CPU usage no relevant differences are introduced by the security protocol with at most a 10 overhead in case of remote communication if the condentiality level is selected Nonetheless the signicantly higher number of requests issued and served when leveraging local communication thanks to absence of the latency introduced by the physical network imposes a considerably higher computational burden on the CPU compared to remote communication Figs 7a and 7b on the other hand present the outcome of the benchmarks evaluating the effect of the security measures on7 the maximum number of requests that can be issued and served in one second In this case denitely similar results have been obtained both in case of local and remote communication being the physical network overheads mitigated by the high number of parallel requests Interestingly enough slightly worse results are associated with local communication however this behavior can be easily explained looking at the CPU load Although both situations are characterized by rather overloaded devices it is worth noting that in case of local communication both the client and the server are being executed at the same time on the same device thus halving the available computational capacity Hence it becomes evident how the number of served requests is in this case limited by the CPU usage which reached 100 Comparing the effect of the different security levels both authentication andcondentiality caused a decrease in the number of served requests accounting for at most one third in case of the biggest payload size considered in the evaluation with the latter security level being slightly more demanding Considering the CPU load no particular variations emerged between the different security levels Yet the overall penalties can be better highlighted computing the CPU load per served requests ratio hence combining the effects on both independent aspects Indeed this metric conrms the introduction on average of a25 overhead in case security is enabled Finally considering the results concerning noticationbased communication not presented here due to space limitations no evident differences can be extrapolated with respect to the simpler requestresponse pattern V C ONCLUSION This paper proposed a novel approach to protect SOMEIP based invehicle communications Given the increasing cars automation unsecured invehicle messages are becoming a tempting target for wicked individuals to eg conceal incomplete repairs or in the extreme case obtain the control of safetycritical systems The main contribution of this paper is a novel security protocol designed to guarantee the authenticity and condentiality of the information exchanged without limiting the capabilities of the network middleware TABLE I briey summarizes the main advantages of our proposal compared to the use of SOMEIP encapsulated within an existing secure protocol First both IPSec L3 security and TLSDTLS L4 security fall short in providing all the functionalities required for full SOMEIP protection support for onetomany communications among all Second they do not t well the communication paradigms adopted byvsomeip namely the presence of a single application responsible for the transmission and reception of remote messages and the usage of interprocess communication IPC between applications residing on the same ECU Indeed they cannot provide real endtoend security between the sending and the receiving applications leaving the internal communications unauthenticated and protecting only the messages owing across the network Our solution instead achieves 100 compatibility with both SOMEIP and vsomeip and features a more efcient handshake procedure Performance measurements conrmed the introduction of limited latency ascribable to the implemented security functionTABLE I COMPARISON BETWEEN SECURE SOMEIP AND SOMEIP OVER L3 IPS ECAND L4 TLSDTLS S ECURITY SOMEIP SOMEIP Secure over IPSec over DTLS SOMEIP Service awareness 7 3 3 Multicast support 7 7 3 Apptoapp security 7 7 3 L4 transparency 3 7 3 IPC protection 7 7 3 alities Considering the likely situation of UDP or TCPbased communications over a physical network in fact additional penalties are almost negligible also in a constrained envi ronment like the automotive one Anyhow even overloading the devices with an excessive amount of trafc slowdowns are deemed to be still sustainable Finally authentication and condentiality levels appear to be characterized by very similar performance with a higher cost associated to the latter only for bigger payloads REFERENCES 1IEEE IEEE standard for Ethernet amendment 1 Physical layer specications and management parameters for 100 Mbs operation over a single balanced twisted pair cable 100BASET1 IEEE Std 8023bw 2015 Amendment to IEEE Std 80232015 pp 188 Mar 2016 2S Tuohy et al Intravehicle networks A review IEEE Transactions on Intelligent Transportation Systems vol 16 no 2 pp 534545 Apr 2015 3AUTOSAR Explanation of Adaptive Platform Design 2017 Online Available httpswwwautosarorgleadminuserupload standardsadaptive1710AUTOSAREXPPlatformDesignpdf 4 SOMEIP