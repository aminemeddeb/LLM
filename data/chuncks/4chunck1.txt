An indepth presentation of the security framework architecture envisioned to protect SOMEIP communications discussing the automotive requirements and justifying the possible design choices iii The extensive experimental assessments of the overhead introduced by the security features carried out using automotivegrade evaluation boards running the developed PoC The remainder of the paper is organized as follows Section II reviews previous cyberattacks and existing solutions to protect invehicle networks Section III presents an overview of the system model increasingly adopted in modern vehicles with specic focus on the SOMEIP middleware Section IV presents the proposed security framework together with a discussion the security properties it can enforce Section V formalizes the security protocol designed to protect SOMEIP communications which is formally veried in Section VI Section VII outlines the advantages of our proposal compared to the usage of SOMEIP over a lower secure protocol while Section VIII presents its experimental evaluation Finally Section IX draws conclusions and proposes directions for further research II R ELATED WORK In this section we motivate the requirements for invehicle security presenting an overview of the main attacks perpetrated against vehicular networks Then we proceed with an overview of the possible solutions proposed by the research community A InVehicle Networks Attacks During the last decade multiple researchers have already analyzed the security of invehicle networks Yet their conclu sions are discouraging pointing out the existence of multiple vulnerabilities that could eventually enable a sufciently skilled attacker to take over the control of even safety critical systems In 2008 Hoppe et al 12 depicted four different attack scenarios that exploiting messages injected into the CAN network allowed the researchers to perform simple actions such as opening the window lift or hiding an incomplete repair Two years later Koscher et al 13 moved on and showed they could control the display of the speedometer kill the engine as well as affect braking by simply injecting messages into the CAN bus of a vehicle The researchreceived widespread criticism because people claimed there were no ways for an attacker to inject these types of messages without being close to the vehicle Nonetheless the same research group 14 succeeded in remotely performing similar attacks by exploiting interfaces such as the MP3 parser of the radio the Bluetooth stack and the telematics unit to get the code executed Finally in 2015 Miller and Valasek clearly demonstrated that remote car hacking of an unaltered vehicle was indeed possible 15 In a nutshell they leveraged a chain of serious vulnerabilities in applications and network stack implementations especially those from the comfort domain eg Bluetooth WiFi and 4G to remotely hack the infotainment system of a 2014 Jeep Cherokee Eventually they succeeded in remotely reprogramming the rmware of a microcontroller to forward messages to the CAN bus gaining the capability to perform a wide range of physical actions through a laptop wherever in the US In 2016 adopting a similar approach Nie et al 16 successfully implemented a remote attack on a Tesla Model S in both Parking and Driving mode B InVehicle Networks Security The security of invehicle networks has already been the topic of many studies Being almost ubiquitous the CAN bus has received widespread attention to increase the overall security and prevent malicious intrusions 1827 Using cryptography at the application layer is the most natural choice when it comes to protect network messages However due to the broadcast nature of the CAN bus as well as the computational constraints imposed by lowend ECUs most current approaches propose the usage of simple Message Authentication Codes MACs to authenticate the messages transmitted 20 26 In this context the biggest challenge resides in the key provisioning phase Although public key cryptography is usually considered out of scope due to the excessive re quirements in terms of computational capacity 25 xed and statically assigned keys are not valuable either being very easy to compromise A possible solution to the key exchange problem involves shortterm keys released in a time dependent fashion as done by the Timed Efcient Stream Loss Tolerant Authentication TESLA protocol 28 Nonetheless this approach introduces a small delay between the reception of a message and the actual verication instant as well as requires the messages to be buffered Conversely other researchers proposed to move from pairwise keys to a groupbased approach In other words acknowledging the onetomany nature of the communication medium they suggested the usage of group keys depending on the trust level associated with each ECU 20 as well as the exploitation of an advanced MAC construction to mix the keys between groups of nodes 18 Finally another subset of solutions leverages the physical properties of the signals transmitted on the CAN bus and the ECUs characteristics as unique patterns in the generation and exchange of the symmetric keys 24 27 To remove the need for cryptography along with its associated complexity and overhead some researchers started exploiting the unique characteristics of CAN signals as an authentication mechanism In particular they showed it was3 possible to obtain a ngerprint of the sender node by applying mathematical functions on the electrical signal characteris tics 19 as well as by measuring the clock drifts in the com munication 23 Although based on empirical measurements these approaches may provide a valuable solution to detect undesired modications to the CAN bus topology including the addition and the replacement of an ECU Acknowledging the typical usage of a centralized gateway to interconnect the different network technologies coexisting in a single vehicle Wolf et al 29 proposed in 2006 to leverage the gateway itself as a rewall to validate the messages exchanged In particular they argued the necessity to enforce rewall rules to prevent ECUs attached to lower restricted networks from sending messages into safetyrelevant bus systems such as CAN Nonetheless different attacks showed this protection alone not being sufcient given the high attack surface exposed by the gateway 15 16 Indeed the central gateway usually acts also as a terminator for the connections from and to the external world eg Bluetooth WiFi and 4G thus becoming a very easy target for an attacker Additionally although a rewall could provide isolation between