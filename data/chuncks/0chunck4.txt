for three different models on Validation dataset Fig 7 Confusion matrices for three different models on Testing dataset Fig 8 ROC Curves and AUC values of each class of the Validation datasets almost all type of attacks on sequences correctly Moreover no signicant difference in performance metrics exists across the three crossvalidations As a result the training process is robust with the selected hyperparameters Figure 6 show a summary of prediction results on the 3 folds for the multiclassication intrusion detection problem during crossvalidation The models have few prediction errors as values outside the diagonal of the confusion matrices approach zero Hence the models have well performed since most of the samples are located in the diagonal of the confusion matrices Figure 8 presents the ROC curves and AUC values for each attack type and for each model microROC and macroROC curves during the threefold crossvalidation The displayed gures has AUC values near 1 which means the 3 modelshave a good measure of separability for the different attack types Furthermore the different roc curves have a point in the upper left corner or coordinate 01 of the ROC space for each model representing the ability of the model to have a a huge sensitivity no false negatives and an outstanding specicity no false positives We have then performed three tests using the three models that were trained during the crossvalidation on the testing dataset Based on the results shown in Table VII Figure 7 and 9 we found that the overall performance of the models is outstanding In fact the trained models were able to generalize to data that they havent seen before and did not merely learn to model the training data In average the model has well predicted the normal behavior of packets in a sequence F1score 099 It is also able to predict the severalFig 9 ROC Curves and AUC values of each class of the Testing dataset TABLE VII RESULTS ON TESTING DATA Model Class Recall Precision F1Score 1Normal 099 099 099 Error on Event 098 093 095 Error on Error 067 097 079 Missing Response 081 088 084 Missing Request 094 093 093 2Normal 099 099 099 Error on Event 1 093 096 Error on Error 081 081 081 Missing Response 079 079 079 Missing Request 088 096 092 3Normal 099 099 099 Error on Event 098 098 098 Error on Error 091 082 086 Missing Response 078 084 081 Missing Request 086 089 087 other types of attack since F1score value varies between 08 and 096 Moreover the models outstanding performance is depicted in Figure 9 since the ROC curves of each class are closer to the topleft corner and the AUC values for the different classes approach 1 VIII L IMITATIONS Our main contribution in this paper is to prove that deep learning algorithms are suitable for detecting intrusions on SOMEIP protocol and classifying them Hence our developed intrusion detection system is considered as an attack classier rather than an anomaly detector However for future work we aim to develop an anomaly based IDS able to detect any type of abnormal behavior and which can be trained using unsupervised learning Furthermore the dataset used for developing the proposed IDS is synthetic and has been processed for ofine intrusion detection ie an intrusion is detected when the session between a client and a server ends However for future work we will be developing a intrusion detection system used for realtime detection and trained using an extracted dataset from real vehicle IX C ONCLUSION SOMEIP is an automotiveembedded communication pro tocol which enhances intercommunication between several ECUs In this paper we have proposed a deep learning basedIDS that can be leveraged to detect intrusions on SOMEIP au tomotive protocol We have generated a labeled dataset to train and evaluate the performance of our model in ofine mode and made it public for reproducibility Performance results show that the proposed models can be successfully implemented to detect multiple types of intrusions on SOMEIP protocol with very large F1Scores and AUC values bigger than 08 for each class For future work we aim to create a SOMEIP packetbased dataset extracted from a real vehicle and test diverse unsupervised learning based IDS that can be deployed for detecting unknown intrusions in realtime REFERENCES 1 Song Hyun Min Jiyoung Woo and Huy Kang Kim Invehicle network intrusion detection using deep convolutional neural network Vehicular Communications 21 2020 100198 2 Chollet Franc ois and others httpskerasio 3 Herold Nadine et al Anomaly detection for SOMEIP using complex event processing NOMS 20162016 IEEEIFIP Network Operations and Management Symposium IEEE 2016 4 SOMEIP Generator Online Available httpsgithubcomEgomania SOMEIPGenerator 5 Gehrmann Tobias and Paul Duplys Intrusion Detection for SOMEIP Challenges and Opportunities 2020 23rd Euromicro Conference on Digital System Design DSD IEEE 2020 6 Iorio Marco et al Securing SOMEIP for InVehicle Service Protec tion IEEE Transactions on Vehicular Technology 6911 2020 13450 13466 7 Iorio Marco et al Protecting invehicle services Securityenabled SOMEIP middleware IEEE Vehicular Technology Magazine 153 2020 7785 8 Rumez Marcel et al An Overview of Automotive ServiceOriented Architectures and Implications for Security Countermeasures IEEE Access 8 2020 221852221870 9 Lauser Timm Daniel Zelle and Christoph Krau Security Analysis of Automotive Protocols Computer Science in Cars Symposium 2020 10 Gmiden Mabrouka Mohamed Hedi Gmiden and Hafedh Trabelsi An intrusion detection method for securing invehicle CAN bus 2016 17th International Conference on Sciences and Techniques of Automatic Control and Computer Engineering STA IEEE 2016 11 Rehman Abdul et al CANintelliIDS Detecting InVehicle Intrusion Attacks on a Controller Area Network using CNN and Attentionbased GRU IEEE Transactions on Network Science and Engineering 2021 12 Seo Eunbi Hyun Min Song and Huy Kang Kim Gids Gan based intrusion detection system for invehicle network 2018 16th Annual Conference on Privacy Security and Trust PST IEEE 2018 13 Han Mee Lan Byung Il Kwak and Huy Kang Kim Anomaly intrusion detection method for vehicular networks based on survival analysis Vehicular communications 14 2018 5263 14 Kang MinJu and JeWon Kang A novel intrusion detection method using deep neural network for invehicle network security 2016 IEEE 83rd Vehicular Technology