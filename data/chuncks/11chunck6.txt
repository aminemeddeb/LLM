struct This allows for extensible structs which allow better migration of interfaces SWSSomeIpXf00216 dIf attribute sizeOfStructLengthFields ofSOMEIP TransformationISignalProps is set to a value greater 0 a length field shall be inserted in front of every serialized struct cSRSXfrm00101 Note SWSSomeIpXf00216 also applies to nested structs which means that additionally every nested struct has its own length field Furthermore in an array of structs where all structs have the same length the length field is inserted in front of every struct inside the array SWSSomeIpXf00252 dIf attribute sizeOfStructLengthField ofSOMEIP TransformationProps is set to a value greater 0 a length field shall be inserted in front of the serialized struct for which the SOMEIPTransformationProps is de fined See TPSSYST02121 cSRSXfrm00101 Note SWSSomeIpXf00252 applies if the length fields of the struct and all nested structs contained within the root struct are configured to different values for the lengths of the length fields via SOMEIPTransformationProps SWSSomeIpXf00217 dThe data type of the length field of the struct and all nested structs within the struct shall be the same and shall be determined by the value ofSOMEIPTransformationISignalProps sizeOfStructLengthFields of the serialized ISignal uint8 ifsizeOfStructLengthFields equals 1 uint16 ifsizeOfStructLengthFields equals 2 uint32 ifsizeOfStructLengthFields equals 4 32 of 107 Document ID 660 AUTOSARSWSSOMEIPTransformerSpecification of SOMEIP Transformer AUTOSAR CP R2111 cSRSXfrm00101 SWSSomeIpXf00253 dIf SOMEIPTransformationProps sizeOf StructLengthField is present for a struct the data type for the length field of the struct shall be determined by the value of SOMEIPTransformationProps sizeOfStructLengthField uint8 ifsizeOfStructLengthField equals 1 uint16 ifsizeOfStructLengthField equals 2 uint32 ifsizeOfStructLengthField equals 4 Otherwise SWSSomeIpXf00217 applies cSRSXfrm00101 SWSSomeIpXf00218 dThe serializing SOMEIP transformer shall write the size in bytes of the serialized struct without the size of the length field into the length field of the structcSRSXfrm00101 SWSSomeIpXf00219 dIf the length is greater than the expected length of a struct as specified in the data type definition a deserializing SOMEIP transformer shall only interpret the expected data and skip the unexpected cSRSXfrm00101 To determine the start of the next expected data following the skipped unexpected part the SOMEIP transformer can use the supplied length information Struct1 uint32 a float32 b2 Struct2 c Struct2 uint32 d float32 e2 Struct3 f serialization uint32 a float32 b1 float32 b2 uint32 d float32 e1 float32 e2 Figure 74 Serialization of Structs without Length Fields Example 33 of 107 Document ID 660 AUTOSARSWSSOMEIPTransformerSpecification of SOMEIP Transformer AUTOSAR CP R2111 Struct1 uint32 a float32 b2 Struct2 c Struct2 uint32 d float32 e2 Struct3 f serialization uint16 lf1 float32 b1 float32 b2 uint32 d float32 e1 float32 e2 uint32 a uint16 lf2 uint16 lf3 Figure 75 Serialization of Structs with Length Fields Example 7243 Structured Datatypes and Arguments with Identifier and optional Mem bers Please note that the content of this chapter has draft character To achieve enhanced forward and backward compatibility an additional Data ID can be added in front of struct members or method arguments The receiver then can skip unknown membersarguments ie where the Data ID is unknown New member sarguments can be added at arbitrary positions when Data IDs are transferred in the serialized byte stream Structs are modeled in the Software Component Template using an Implementa tionDataType of category STRUCTURE and members are represented by Imple mentationDataTypeElement s Method arguments are represented by Argument DataPrototypes Refer to 9 for more details The assignment of Data IDs is modeled in the System Template in the context of SOMEIPTransformationISignalProps Refer to 7 for more details Moreover the usage of Data IDs allows describing structs with optional members To serialize data with optional members the transformer has to know which optional mem bers are available or not This is stored in a bitfield which is contained inside the Im plementationDataType This availabilityBitfield is realized as array of uint8 Whether an optional member is actually present in the struct or not must be deter mined during runtime In addition to the Data ID a wire type encodes the datatype of the following member Data ID and wire type are encoded in a socalled tag 34 of 107 Document ID 660 AUTOSARSWSSOMEIPTransformerSpecification of SOMEIP Transformer AUTOSAR CP R2111 SWSSomeIpXf00267 dThe length of a tag shall be two bytes cSRSXfrm00106 SWSSomeIpXf00268 dThe tag shall consist of reserved Bit 7 of the first byte wire type Bit 64 of the first byte Data ID Bit 30 of the first byte and bit 70 of the second byte Bit 7 is the highest significant bit of a byte bit 0 is the lowest significant bit of a byte c SRSXfrm00106 Note Refer to Figure 76 for the layout of the tag Wire TypeData ID Higher Sig PartData ID Lower Sig Part Length Field 81632 bit Member Data Byte n Byte n 1 Byte n 2 7 0 7 071531 0reserved Figure 76 SOMEIP Struct Tag Layout SWSSomeIpXf00269 dThe lower significant part of the Data ID of the member shall be encoded in bits 70 of the second byte of the tag The higher significant part of the Data ID of the member shall be encoded in bits 30 of the first byte cSRSXfrm 00106 Example The Data ID of the member is 1266 dec Then bits 30 of the first byte are set to 0x4 The second byte is set to 0xF2 SWSSomeIpXf00270 dThe wire type shall determine the type of the following data of the member The value shall be assigned as shown in Table 79 cSRSXfrm 00106 Wire Type Value 0 8 Bit Data Base data type 1 16 Bit Data Base data type 2 32 Bit Data Base data type 3 64 Bit Data Base data type 4 Complex Data Type Array Struct String Union with length field of static size configured in data definition 5 Complex Data Type Array Struct String Union with length field size 1 byte ignore static definition 6 Complex Data Type Array Struct String Union with length field size 2 byte ignore static definition 7 Complex Data Type Array Struct String Union with length field size 4 byte ignore static definition Table 79 Message Types 35 of 107 Document ID 660 AUTOSARSWSSOMEIPTransformerSpecification of SOMEIP Transformer AUTOSAR CP R2111 Note Wire type 4 ensures the compatibility with the