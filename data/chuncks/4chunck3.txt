parameters The core of vsomeip resides in the concept of routing manager ie the entity responsible for the effective delivery of network messages Two different versions of the routing manager entity do coexist and are loaded transparently by the library at startup time routing manager the fully functional version of the module adopted by a single application for each physical ECU It acts as a gateway in charge of the communication with applications residing on remote devices In other words this is the only instance establishing external network connections and managing the transport endpoints ie UDP and TCP sockets Finally it takes care of loading the service discovery module and internally propagating the information received routing manager proxy loaded by all the other instances and capable of local communications only ie imple mented through Unix domain sockets Hence messages addressed to remote recipients are rst transmitted to the main routing manager which forwards them to the intended destination There the inverse process may need to be executed Service messages are continuously 1httpsgithubcomGENIVIvsomeipexchanged between the proxies and the master instance to share the knowledge on offered and requested services and to allow the delivery of notications As for security vsomeip can optionally leverage Unix credentials to authenticate local connections However the total lack of protection regarding network messages as well as the usage of unauthenticated conguration les restrict the usability of this solution to a rather limited niche of use cases D DDS Data Distribution Service DDS 35 is a datacentric communication middleware based on the publishsubscribe pattern and standardized by the Object Management Group OMG in 2004 the latest version 14 was released in 2015 It targets distributed realtime systems in the industrial IoT domain and it is currently adopted in many verticals including transportation energy medical systems industrial automation aerospace and defence2At its core DDS is based on topics an abstraction associating a unique name and a data type to the actual data writers publish content in a topic that readers can subscribe to getting notied of its availability Each topic can be assigned a set of Quality of Service QoS descriptors to characterize reliability security and storage requirements Additionally dynamic discovery functionalities are featured to enable plugandplay DDS applications Finally although strongly oriented towards publishsubscribe communication in 2017 the DDS specications were extended to implement classical RPC on top of its basic building blocks 36 To exchange the actual information on the network DDS leverages a custom wire protocol named RealTime Publish Subscribe RTPS 37 It introduces an abstraction layer implementing transportagnostic reliability and fragmentation features on top of classical protocols such as TCP and UDP hence providing reliable channels even on top of connection less and multicast IP communications The DDS approach to security is also transportagnostic being based on an extension of the RTPS capabilities 38 In a nutshell it aims to enforce authentication and authorization of DDS readers and writers as well as integrity and condentiality of the data exchanged DDS appears to a be viable alternative for the automotive domain and it is also characterized by some benets over SOMEIP QoS management and security among all To this end although the AUTOSAR aracom communication management API designed as part of the Adaptive Platform was initially modeled around SOMEIP concepts ie methods events and elds as well as its service discovery protocol the support for DDS has been introduced in newer versions Yet SOMEIP still appears to hold a privileged position in the automotive domain thanks to its support for simpler ECUs running Classic AUTOSAR as well as its tighter integration within the AUTOSAR framework For these reasons we believe an improvement in the SOMEIP security to be of paramount importance and in the remainder of the discussion we will focus explicitly on this middleware while leaving a complete comparison between the two solutions as a future work 2httpswwwddsfoundationorgwhoisusingdds25 IV S ECURING SOMEIP This section presents the key characteristics of our security framework which mainly consists of a twophase security protocol meant to provide improved security to SOMEIP It is composed of an initial session establishment phase performed at startup time between each application interested in accessing a SOMEIP service and the corresponding offerer Asymmetric cryptography is leveraged to ensure that only authorized parties can start the communication as well as to exchange the data necessary for the subsequent protection Once the session establishment correctly completed the actual runtime protection can take place Symmetric cryptography is adopted to enforce the efcient exchange of secured SOMEIP messages according to the security level selected in the previous phase Our solution was driven by the desire to achieve complete compatibility with the communication middleware avoiding to introduce any limitations that may constraint the dynamism typical of SOMEIP First security features shall be as much transparent as possible from the applications point of view In other words the denition of the permitted trafc matrix shall be performed by means of highlevel authorization rules ie in terms of services without having to deepen the network parameters abstracted by the middleware Second the protection shall be compatible with all the communication models supported by SOMEIP regardless of the transport protocol adopted for the actual delivery of the messages In particular it shall transparently cope with both onetoone ie unicast and onetomany ie multicast transmissions the latter being exploited for the efcient delivery of notications The remainder of this section is organized as follows We start delineating the adversary model assumed for the rest of the discussion Then we outline the most noteworthy characteristics of the security framework focusing on the granularity adopted and motivating the available security levels Additionally we discuss the methodology proposed to express at a high level the authorization rules as well as the strategy selected to secure multicast messages Finally Section V formally describes the actual security protocol proposed to secure SOMEIP messages A Threat model In this work we assume the adversary may have full control over the Ethernet network being able to insert replay eavesdrop modify and drop arbitrary messages Yet we do not consider DenialofService DoS attacks leaving their protection as future work As for cryptography we assume