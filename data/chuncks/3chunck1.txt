link Different applications are being executed at the same time on the top of a Linux kernel Each one is characterized by its own instance of the vsomeip library which can be further subdivided into two main building blocks The upper part shows the module providing the public API which is exploited by all applications for the interaction with the library itself The core part of vsomeip is the routing manager entity responsible for message delivery both locally and remotely Two different types of the routing manager do coexist and are completely transparent from the applications point of view routing manager the fulledged version loaded by only one application per each device It is responsible for sending messages to and receiving them from applications residing on remote devices by managing the transport endpoints ie the TCP and UDP sockets Furthermore it is in charge of loading the service discovery if enabled routing manager proxy executed by all the other instances and in charge of the communications with other applica tions residing on the same ECU leveraging Unix domain 1httpsgithubcomGENIVIvsomeip Application A1 vsomeip API Routing Manager Routing Manager Stub Local Endpoint Service Discovery TCPUDP EndpointApplication A2 vsomeip API Local EndpointRouting Manager Proxy IPCApplication B1 vsomeip API Routing Manager Routing Manager Stub Service Discovery TCPUDP Endpoint EthernetTCPUDP TCPUDPECU 1 ECU 2Fig 1 vsomeip architecture freely redrawn from 12 sockets while messages toward remote recipients are redirected to the main routing manager According to the vsomeip documentation the framework includes some security features based on Unix credentials thus available only for local communications Nonetheless these capabilities appear to be somehow limited and weak due to the total lack of protection for what regards communications between remote devices and the usage of unauthenticated conguration les III S ECURING SOMEIP Our security framework aiming to protect SOMEIP com munications has been designed to operate at service instance granularity Hence each instance of a SOMEIP service is considered as a unique entity to which a specic application can be either allowed or denied access Nonetheless being services just logical abstractions grouping together methods and events the nal security granularity depends on the architectural decisions made by application developers A different security level among the three incremental alter natives enumerated in the following can be assigned to each service instance thus it is possible to select for each service the best balance between protection and computationalnetwork overhead 1Nosec corresponding to vanilla SOMEIP Although not providing any security property it may be suitable for very simple and lowcriticality services since it introduces no additional complexity to the transmission 2Authentication assuring that only allowed applications can send messages associated to a specic service in other words it attests data authentication and integrity Additionally this security level also prevents replay3 attacks characterized by the capture of valid packets for a subsequent retransmission to trigger again the same action These security properties are deemed to be fundamental in vehicular networks Indeed while data exchanged may not need to remain secret it is of the highest importance that every application processes the information received only when its authenticity and in tegrity is assured Otherwise malicious messages injected in the network could succeed in fooling the application logic possibly triggering safetycritical physical actions at arbitrary time intervals 3Condentiality guaranteeing all the security properties offered by the authentication level and additionally data condentiality to preclude unauthorized parties from accessing the information exchanged Hence although being named condentiality this security level com bines all the three main security properties that can be associated to messages authentication integrity and condentiality Condentiality alone would not be able to provide sufcient security an attacker in fact would remain able to inject malicious messages undetectable by the receivers albeit with only unpredictable payloads Even though currently not characterized by the same importance of the other security properties the intro duction of condentiality might be useful also in in vehicle networks In particular application developers could assign this security level to prevent unauthorized aftermarket ECUs from reading the messages exchanged on the bus thus selectively limiting their ability to grab external information Additionally it may contribute to the protection of intellectual property avoiding that the content of network messages provides hints about complex application logic A Security protocol The core of the solution proposed is represented by a security protocol which is made up of an initial handshake phase for session establishment followed by the transmission of secured messages The former is carried out at startup between each requester of a service and the offerer by exploiting asymmetric cryptography Consequently each application needs to be accompanied by a private key and the corresponding signed digital certicate which trustworthily enumerates all the service instances optionally through wildcards it is allowed to either offer or request along with the minimum security level that must be guaranteed for each of them To this extent digital certicates can be leveraged by car makers as a sort of contract to certify that applications developed either internally of by thirdparties are indeed allowed to request andor offer a predetermined set of services Fig 2 sketches a possible format of avsomeip entry within a digital certicate containing all the required pieces of information To achieve complete compatibility with the SOMEIP mid dleware we consider also multicast communications in addition to unicast messages For this reason group protection is proposed to secure the messages belonging to a specic service instance a single symmetric key is randomly generated by the vsomeip 0x1234 0x5678 offer authentication Keyword Service IDInstance ID or Offer or RequestMinimum security levelFig 2 Format of a vsomeip entry inside the digital certicate offerer and securely shared with all the requesters during the session establishment phase Although better isolation could be provided by using multiple keys the selected strategy is deemed to provide a good tradeoff between security and complexity Indeed symmetric keys being automatically regenerated every time a service is started are assumed to last only for a limited time reducing to a great extent the possibilities for a successful attack Nonetheless in case of longrunning services a re keying mechanism would become necessary according to a wellestablished practice B