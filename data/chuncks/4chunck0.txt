1 Securing SOMEIP for In Vehicle Service Protection Marco Iorio Massimo Reineri Fulvio Risso Riccardo Sisto and Fulvio Valenza Abstract Although highspeed invehicle networks are being increasingly adopted by the industry to support emerging use cases previous research already demonstrated that car hacking is a real threat This paper formalizes a novel framework proposed to provide improved security to the emerging SOMEIP middleware without introducing at the same time limitations in the communication patterns available Most notably the entire trafc matrix is designed to be congured using simple high level rules clearly stating who can talk to whom according to the service abstraction adopted by SOMEIP Three incremental security levels are made available accounting for different services being associated with different requirements The core security protocol encompassing a session establishment phase followed by the transmission of secured SOMEIP messages has been formally veried to prove its correctness in terms of authentication and secrecy properties Performancewise in depth experimental evaluations conducted with an extended version of vsomeip conrmed the introduction of quite limited penalties compared to the bare unsecured implementation Index Terms SOMEIP Invehicle security SOA protection I I NTRODUCTION MODERN vehicles are running on code as much as on gasoline 1 2 Besides the electrication trend one of the core aspects of the 21stcentury automobile relates to the development of increasingly smarter and more complex applications to manage every single aspect of the vehicle and provide a richer onboard experience First most operations that used to be performed through mechanical linkages are nowa days managed by electronic systems and control algorithms according to the drivebywire paradigm Second Advanced Driving Assistance Systems ADAS are shifting the control of safetycritical systems such as braking and steering to computers algorithms and software 3 They aim to increase the overall safety by relieving the driver of tedious tasks reacting faster in case of emergency and preventing accidents caused by human errors Third the humanvehicle interface HMI design is currently being reinvented developing novel infotainment systems to provide more engaging interactions between driver passengers and vehicle 4 To support an increasing number of functionalities com mon vehicles encompass tens of different Electronic Control Units ECUs ranging from lowend microcontrollers to high performance CPUbased systems 5 At the same time wirings and communication protocols constitute the backbone enabling the exchange of information between distributed applications Copyright c 2015 IEEE Personal use of this material is permitted However permission to use this material for any other purposes must be obtained from the IEEE by sending a request to pubspermissionsieeeorg M Iorio F Risso R Sisto and F Valenza are with the Politecnico di Torino DAUIN Torino Italy namesurnamepolitoit M Reineri is with Italdesign Moncalieri Italy namesurnameitaldesignitAs for invehicle networks the most widespread standard is a broadcast messageoriented bus named Communication Area Network CAN bus 6 Remarkably it adopts a lossless bitwise arbitration method of contention resolution making it suitable for strong realtime applications Yet many emerging applications especially those from the comfort domain are progressively associated with higher bandwidth requirements eg to transmit video streams while partially relaxing the strict realtime constraints To this end Automotive Ethernet 7 a slightly modied version of the widespread standard designed to meet the invehicle EMC requirements is emerging prominently as a candidate to replace a plethora of complex proprietary technologies 8 9 At the same time the Service Oriented Architecture SOA paradigm is being increasingly adopted to meet the requirements for modularity dynamism and update capability According to this design pattern a system is composed of a set of services providing different functionalities either offered or consumed by the actual applications In this context SOMEIP 10 is a network middleware standardized in 2016 by AUTOSAR explicitly to fulll all the typical automotive use cases Most notably it provides an easytouse SOA abstraction on the top of traditional transport protocols such as TCP and UDP Nonetheless the SOMEIP specications completely lack security measures directly embedded in the protocol Although it has been designed to operate on the top of classical transport protocols theoretically enabling the usage of effective and mature security protocol suites such as IPSec and TLS they appear not to t well all the different automotive communication patterns thus introducing unwanted limitations to the middle ware IPSec for instance could be adopted to establish secured tunnels between different ECUs However being application unaware it would not guarantee the authentication of the differ ent parties involved in the communication TLS on the other hand does not support multicast communications leveraged by SOMEIP to limit transmissions on the communication medium when possible Moreover it is characterized by a fairly complex authentication handshake being a generalpurpose security protocol Yet during the last decade the research community has already clearly demonstrated the need for secure invehicle communication protocols Indeed multiple researchers have discovered a wide range of possible vulnerabilities concerning both ECUs software and invehicle networks especially the CAN bus being totally unsecured and given its relevance in the vehicular domain 11 allowing a possible attacker to take over the control of even safetycritical systems 1216 All in all this is a clear evidence that isolation and security through obscurity can no longer be assumed as sufcient protections This paper lls the identied gap by presenting a novel secu2 rity framework designed to protect SOMEIP communications The core of our proposal in addition to providing complete compatibility with the communication middleware is based on two main pillars First the denition of simple highlevel authorization rules to specify the trafc matrix allowed in terms of services according to the SOA pattern adopted by SOMEIP Second the possibility to assign different security levels to different services depending on how critical they are Hence it allows to get the best compromise between security and overhead Starting from the highlevel ideas anticipated in 17 this paper presents the continuation of the above research work which led to a rigorous denition of the framework and of its security protocol Specically our main contributions are as follows i The formalization of the security protocol including the authorization mechanism and its formal verication to provide high assurance that the desired security properties hold ii