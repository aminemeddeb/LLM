in Figure 710 SWSSomeIpXf00236 dIf the value of dynamicArraySizeProfile of a multi dimensional variable size array equals VSASQUARE the value of all length fields of the nested serialized variable size arrays that belong to this multidimensional variable size arrays shall be calculated based on the value of the single size indicator of the AUTOSAR data type cSRSXfrm00101 SRSXfrm00008 49 of 107 Document ID 660 AUTOSARSWSSOMEIPTransformerSpecification of SOMEIP Transformer AUTOSAR CP R2111 In case of VSASQUARE the AUTOSAR data type only has one size indicator The value of this size indicator will be used as base for the calculation for the value of all length fields of such a multidimensional variable size array SWSSomeIpXf00237 dIf the value of dynamicArraySizeProfile of a multi dimensional variable size array equals VSARECTANGULAR the values of all length fields of the nested serialized variable size arrays of the same nesting level ie the same dimension that belong to this multidimensional variable size array shall be cal culated based on the values of the size indicators of the AUTOSAR data type for this respective nesting level cSRSXfrm00101 SRSXfrm00008 In case of VSARECTANGULAR the AUTOSAR data type has exactly one size indicator for each dimension of the the multidimensional variable size array For all variable size arrays in one dimension the value of the according size indicator of this dimension will be used as base for the calculation of the values of all length fields of this dimension SWSSomeIpXf00238 dIf the value of dynamicArraySizeProfile of a multi dimensional variable size array equals VSAFULLYFLEXIBLE the values of all length fields of the nested serialized variable size arrays that belong to this multidimensional variable size arrays shall be calculated based on the value of the size indicator of the corresponding variable size array that is contained in the AUTOSAR data type cSRS Xfrm00101 SRSXfrm00008 In case of VSAFULLYFLEXIBLE in the AUTOSAR data type the outer variable size array and each nested variable size arrays has its own size indicator For the calculation of the values of the length fields both of the outer and all nested variable size arrays the according values of the size indicators of the AUTOSAR data type will be used as base The RTE provides a buffer where serialization result will be written into by the SOMEIP transformer which is large enough to keep the length field and a fully filled dynamic array 7248 Bitfield SWSSomeIpXf00300 dBitfields shall be transported as basic datatypes uint8uint16uint32 c 7249 Union Variant A union also called variant is a parameter that can contain different types of elements For example if one defines a union of type uint8 and type uint16 the union shall carry an element of uint8 or uint16 The union serialization will only be triggered if the pattern defined in SWSSomeIpXf00249 applies 50 of 107 Document ID 660 AUTOSARSWSSOMEIPTransformerSpecification of SOMEIP Transformer AUTOSAR CP R2111 SWSSomeIpXf00249 dA union shall be detected if an Implementation DataType with the following pattern named wrapped union data type is used Im plementationDataType with category STRUCTURE that contains exactly two Im plementationDataTypeElement s memberSelector ImplementationDataTypeElement which represents the type field that boils down to a uint8 uint16 or uint32 Implementation DataType payload ImplementationDataTypeElement of category UNION which rep resents the actual union cSRSXfrm00101 When using different types of elements the alignment of subsequent parameters may be distorted To resolve this padding might be needed SWSSomeIpXf00088 dThe default serialization layout of unions in SOMEIP is shown in Table 710 cSRSXfrm00101 Length field optional Type field Element including padding sizeofpadding length sizeofelement Table 710 Default serialization layout of unions SOMEIP allows to add a length field of 8 16 or 32 bit in front of unions The length field of a union describes the number of bytes in the union This allows the deserializer to quickly calculate the position where the data after the union begin in the serialized data stream This gets necessary if the union con tains data which are larger than expected for example if a struct was extended with appended new members and only the first old members are deserialized by the SOMEIP transformer SWSSomeIpXf00224 dIf attribute sizeOfUnionLengthFields ofSOMEIP TransformationISignalProps is set to a value greater 0 a length field shall be inserted in front of every serialized union cSRSXfrm00101 Note SWSSomeIpXf00224 also applies to nested unions which means that additionally every nested union has its own length field SWSSomeIpXf00254 dIf attribute sizeOfUnionLengthField ofSOMEIP TransformationProps is set to a value greater 0 a length field shall be inserted in front of the serialized union for which the SOMEIPTransformationProps is de fined See TPSSYST02121 cSRSXfrm00101 Note SWSSomeIpXf00254 applies if the length fields of the union and all nested unions 51 of 107 Document ID 660 AUTOSARSWSSOMEIPTransformerSpecification of SOMEIP Transformer AUTOSAR CP R2111 contained within the root union are configured to different values for the lengths of the length fields via SOMEIPTransformationProps SWSSomeIpXf00225 dThe data type of the length field of the union and all nested unions within the union shall be determined by the value of SOMEIPTransforma tionISignalProps sizeOfUnionLengthFields of the serialized ISignal uint8 ifsizeOfUnionLengthFields equals 1 uint16 ifsizeOfUnionLengthFields equals 2 uint32 ifsizeOfUnionLengthFields equals 4 cSRSXfrm00101 SWSSomeIpXf00258 dIfSOMEIPTransformationProps sizeOfUnion LengthField is present for a union the data type of the length field for the union shall be determined by the value of SOMEIPTransformationProps sizeOfU nionLengthField uint8 ifsizeOfUnionLengthFields equals 1 uint16 ifsizeOfUnionLengthFields equals 2 uint32 ifsizeOfUnionLengthFields equals 4 Otherwise SWSSomeIpXf00225 applies cSRSXfrm00101 SWSSomeIpXf00226 dThe serializing SOMEIP transformer shall write the size in bytes of the serialized union including padding bytes but without the size of the length field and type field into the length field of the union This requirement does not apply for the serialization of extensible structs and methods cSRSXfrm00101 Note See also chapter 7243 SWSSomeIpXf00227 dIf the length is greater than the expected length of a union as specified in the data type definition a deserializing SOMEIP transformer shall only interpret the expected data and skip the unexpected cSRSXfrm00101 To determine the start of the next expected data following the skipped unexpected part the SOMEIP transformer can use the supplied length information The length of the type field shall be 32 16 8 or