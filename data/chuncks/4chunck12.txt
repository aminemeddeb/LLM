thus strongly attening the possible impact of the security features G Hardware Acceleration For the sake of generality the performance evaluation has been completed adopting software cryptographic implementa tions only However typical automotive ECUs may be comple mented with hardware accelerators Hence being the iMX7 family of boards characterized by a Cryptographic Accelerator and Assurance Module CAAM we investigated also the performance achievable when leveraging ofoading features To this end we exploited the cryptodevlinux kernel module5 which provides an abstraction to allow userspace applications eg OpenSSL to transparently benet from hardware accelerators Focusing on symmetric cryptography we managed to ofoad AESCBC encryption and HMAC SHA1 authentication along with other legacy algorithms Yet no authenticated encryption support seemed to be provided Fig 8 presents an evaluation targeting AES128CBC which compares the performance of the software and the hardware implementations in terms of throughput ie amount of data encrypted per second and CPU usage6Two different scenarios have been considered i the encryption of a stream of chunks 5httpcryptodevlinuxorg 6Differently from the previous benchmarks this evaluation has been performed independently from the SOMEIP middleware to better highlight the performance differences of the cryptographic algorithms15 of data eg a TCP ow using the same cryptographic context iekeyiv pair ii the encryption of independent messages such as those generated by SOMEIP hence the context is reinitialized before every operation ie varying the iv to avoid requiring a strict ordering during the reception eg if messages are transmitted over UDP Focusing rst on the results using the software implementation no relevant differences emerged when varying either the size of the chunks to be encrypted or the scenario considered Indeed the throughput remained stable around 24 MBs with 100 single core CPU usage The outcome of the measurements leveraging the hardware ofoading capabilities on the other hand turned out to be strongly inuenced by the amount of data to be encrypted Yet this dependency could be easily explained by the high overhead required to switch from user to kernel space and interact with the hardware module which pays off only with larger blocks both in terms of throughput and CPU usage with the latter going as low as 5 in the best case Additionally the reinitialization of the cryptographic context ie scenario ii proved to cause serious performance drops loosing all the advantages associated with hardware acceleration This preliminary evaluation pointed out some limitations of the hardware module featured by the testbed suggesting the adoption of software implementations in our PoC and for the benchmarks Indeed it provides limited support for stateoftheart cryptographic algorithms eg authenticated encryption ones as well as it is characterized by unsatisfactory performance especially in case of small messages Indeed ChaCha20Poly1305 consistently achieved better results even though it combines both encryption and authentication in a single interface and offers a 256 bits security level Although bound to the specicity of the platforms and the abstractions adopted we believe these measurements can shed some light on the possible limitations of hardware acceleration IX C ONCLUSIONS AND FUTURE WORK Novel invehicle services using highspeed communications are being increasingly implemented Yet over the last decade many researchers have demonstrated that unsecured network messages pose a serious threat in the vehicular domain perhaps granting a malicious entity the control of safetycritical systems and endangering the life of the passengers Starting from these considerations we proposed a novel framework to secure SOMEIP an emerging middleware designed by the AUTOSAR consortium to account for futureproof scenarios Differently from the encapsulation of SOMEIP messages within a lower secure protocol our solution aims to introduce no limitations in the functionalities provided by the middleware as well as being 100 compatible with its opensource implementation vsomeip Simple highlevel rules are leveraged to allow auto motive companies to specify the set of peers each application is authorized to talk to sticking to the service abstraction adopted by SOMEIP In addition three incremental security levels are made available in order to associate each service to the one best matching its requirements The security protocol at the core of our solution has been formally modeled and veried so providing high assurance that the expected security propertieshold Finally extensive experimental evaluations conrmed the introduction of a fairly limited overhead during both the establishment of secure sessions and the runtime protection Nonetheless most of the burden is ascribable to cryptography better performance could be achieved using a weaker yet faster algorithm or leveraging more powerful hardware accelerators to relieve the main CPU from the task Future work will focus on preventing DoS attacks aiming to overload the devices with an excessive amount of trafc to prevent legitimate communications Additionally a thorough study will be carried out to understand how to integrate the security protocol with hardware security to preclude sufciently motivated attackers from tampering with cryptographic material ACKNOWLEDGMENT We thank Paolo Montuschi for the precious suggestions he gave us to improve the paper REFERENCES 1R N Charette This car runs on code IEEE spectrum vol 46 no 3 p 3 Feb 2009 2O Burkacky J Deichmann G Doll and C Knochenhauer Rethinking car software and electronics architecture McKinsey Co Feb 2018 3H Winner S Hakuli F Lotz and C Singer Handbook of driver assistance systems Basic information components and systems for active safety and comfort Springer 2015 4G Meixner and C Mller Automotive User Interfaces Creating Interactive Experiences in the Car Springer 2017 5M Broy Challenges in automotive software engineering in Proc 28th ACM Int Conf Software Engineering May 2006 pp 3342 6K H Johansson M Trngren and L Nielsen Vehicle applications of controller area network in Handbook of networked and embedded control systems Springer 2005 pp 741765 7IEEE IEEE standard for Ethernet amendment 1 Physical layer specications and management parameters for 100 Mbs operation over a single balanced twisted pair cable 100BASET1 IEEE Std 8023bw 2015 Amendment to IEEE Std 80232015 pp 188 Mar 2016 8L L Bello The case for Ethernet in automotive communications SIGBED Rev vol 8 no 4 pp 715 Dec 2011 9S Tuohy M Glavin C Hughes E Jones M Trivedi and L Kilmartin Intravehicle networks A review IEEE Trans Intell Transp Syst vol 16 no