SOMEIP Intrusion Detection using Deep Learningbased Sequential Models in Automotive Ethernet Networks 1stNatasha Alkhatib LTCI Telecom Paris IP Paris Palaiseau France natashaalkhatibtelecomparisfr2ndHadi Ghauch LTCI Telecom Paris IP Paris Palaiseau France hadighauchtelecomparistechfr3rdJeanLuc Danger LTCI Telecom Paris IP Paris Palaiseau France jeanlucdangertelecomparisfr Abstract Intrusion Detection Systems are widely used to detect cyberattacks especially on protocols vulnerable to hacking attacks such as SOMEIP In this paper we present a deep learningbased sequential model for ofine intrusion detection on SOMEIP application layer protocol To assess our intrusion detection system we have generated and labeled a dataset1with several classes representing realistic intrusions and a normal class a signicant contribution due to the absence of such publicly available datasets Furthermore we also propose a recurrent neural network RNN as an instance of deep learning based sequential model that we apply to our generated dataset The numerical results show that RNN excel at predicting in vehicle intrusions with F1 Scores and AUC values greater than 08 depending on each intrusion type Index Terms Intrusion detection Recurrent Neural Network SOMEIP Serviceoriented communication Automotive Ether net Invehicle security Sequential Models Deep Learning I I NTRODUCTION Automobiles are no longer solely made up of mechanical systems In fact mechanical components have been taken over by electronics called Electronic Control Units ECUs These connected ECUs through various invehicle network infrastructures CAN FlexRay MOST and LIN are in charge of making various car functions possible However these traditional invehicle networks have many limitations in terms of bandwidth and higher layer protocols An adaptable and scalable invehicle network technology is thus required to realize sophisticated and innovative customer functions such as Adaptive cruise control Collision avoidance Driver drowsi ness detection Lane departure warning and others To fulll these automotive requirements Automotive Ethernet tech nologies have been developed and standardized The deployment of Ethernetbased communication in in vehicle network systems has several other benets such as the ability to reuse the associated OSI layers protocols built and tested in other industries 21 Furthermore this cutting edge technology enables the invention of new protocols for individual layers while reusing protocols for the rest such as the development of the automotive application layer protocol 1Dataset URL httpsgithubcomAlkhatibnatashaSOMEIP IDSScalable serviceOriented MiddlewarE over IP SOMEIP 15 SOMEIP is commonly used for relevant automotive ap plications due to its servicebased communication approach and its adaptability to different automotive operating systems eg QNX OSEK and Linux 21 In other words SOMEIP is increasingly adopted to coordinate the exchange of various services between disjoint applications on distinct ECUs These services cover notications about invehicle events as well as Remote Procedure Call RPC functions that enable an ECU client to request information from an ECU server However no security measures such as authentication or encryption are dened in the SOMEIP protocol specication 3 In fact the absence of SOMEIP security protocols may set the ground for an attacker to exploit a legitimate automotive system and initiate attacks from inside the network such as intercepting and manipulating messages between two ECUs and other signicant threats To reduce the risk of the various inherent security threats a robust defense plan is needed which rst requires detecting and analyzing these vulnerabilities Due to their large approximation capacity deep learning based approaches are wellsuited to detect network intrusions in various network types 1 14 In this work we have devel oped a deep learning based sequential model to detect network intrusions on the SOMEIP protocol Sequential models are a category of deep learning model where the training set is known apriori to have a dominant temporal or causal component indeed packets in a session of the SOMEIP protocol exhibit a strong temporal correlation as each packet depends on previous ones In the current work we will contribute to the development of a sequencebased SOMEIP dataset as no public SOMEIP dataset exists Specically we generate and label a SOMEIP dataset with four classes of general intrusion packets as well as a class of normal packets Moreover our proposed deep learningbased model a recurrent neural network RNN is able to classify these four intrusions on packets sequences and the normal ones with very large accuracy and F1 score Furthermore we will evaluate our deep learningbased sequential model using thearXiv210808262v2 csCR 10 Oct 2021generated dataset Towards this end our paper is organized into six sections Section 2 discusses main publications that are related to SOMEIP intrusion detection In section 3 we present an overview of the SOMEIP protocol In section 4 we present our dataset and the different considered attacks The suggested sequential model is presented in Section 5 In section 6 we present the different evaluation metrics used for performance evaluation We discuss our experimental results in section 7 Finally we conclude our paper with future work direction Fig 1 SOMEIP packet II R ELATED WORK Deep Learning approaches were highly used in previous works to detect network intrusions on the traditional invehicle network protocol CAN 10 11 12 14 However no previous work has been addressed to detect intrusions on Automotive Ethernet especially SOMEIP protocol using Deep Learning due to the following reasons Lack of Automotive Ethernet dataset The existence of large CAN databases 13 containing both normal and abnormal network trafc behaviour has resulted in ex tensive research into deep learning applications on CAN However SOMEIP application layer protocol does not have wellknown dataset available Despite the fact that a new Automotive Ethernet dataset is recently published 22 it is not helpful for our current work since it covers normal and abnormal streams of audiovideo transport protocol A VTP which is different than SOMEIP pro tocol Thus the generation of the labeled dataset and its publication is one but not the only contribution of the current paper Automotive Ethernet Standard gaining momentum Automotive Ethernet a recent network protocol for ve hicles is gaining increasing momentum in standards for connected vehicles In terms of SOMEIPs latest security vulnerability investi gations researchers have begun to investigate its key vul nerabilities that could lead to cyberattacks on the invehicle network as well as to develop IDS using different approaches Fig 2 Congured Network Different SOMEIP clients and servers ex changing SOMEIP services over