wire type and length field cSRSXfrm00106 SWSSomeIpXf00294 dIf the transformer cannot find a required ie nonoptional member defined in its data definition in the serialized byte stream the deserialization shall be aborted with ESERMALFORMEDMESSAGE For examples please refer to 10cSRSXfrm00106 7244 Strings SWSSomeIpXf00053 dStrings shall be encoded using Unicode and terminated with a textbackslash0character for both fixedlength and dynamiclength strings Unused space shall be filled using 0cSRSXfrm00101 SWSSomeIpXf00054 dDifferent Unicode encoding shall be supported including UTF8 UTF16BE and UTF16LE Since these encoding have a dynamic length of bytes per character the maximum length in bytes is up to three times the length of characters in UTF8 plus 1 Byte for the termination with a 0 or two times the length of the characters in UTF16 plus 2 Bytes for a 0 UTF8 character can be up to 6 bytes and an UTF16 character can be up to 4 bytes cSRSXfrm00101 SWSSomeIpXf00055 dUTF16LE and UTF16BE strings shall be zero terminated with a textbackslash0character This means they shall end with at least two 0x00 Bytes cSRSXfrm00101 SWSSomeIpXf00056 dUTF16LE and UTF16BE strings shall have an even lengthcSRSXfrm00101 SWSSomeIpXf00057 dFor UTF16LE and UTF16BE strings having an odd length the last byte shall be silently removed by the receiving SOMEIP transformer cSRS Xfrm00101 SWSSomeIpXf00248 dIn case of UTF16LE and UTF16BE strings having an odd length after removal of the last byte the two bytes before shall be 0x00 bytes termi nation for a string to be valid cSRSXfrm00101 SWSSomeIpXf00058 dAll strings shall always start with a Byte Order Mark BOM The BOM shall be included in fixedlengthstrings as well as dynamiclength strings c SRSXfrm00101 For the specification of BOM see 11 and 12 Please note that the BOM is used in the serialized strings to achieve compatibility with Unicode 39 of 107 Document ID 660 AUTOSARSWSSOMEIPTransformerSpecification of SOMEIP Transformer AUTOSAR CP R2111 SWSSomeIpXf00239 dThe String specific serialization will only be triggered if an Unicode String is detected and implementsLegacyStringSerialization is false cSRSXfrm00101 For the details of the recognition and serialization of fixed and dynamiclength strings see chapter 72441 and chapter 72442 SWSSomeIpXf00059 dThe receiving SOMEIP transformer implementation shall check the BOM and handle a missing BOM or a malformed BOM as an error cSRS Xfrm00101 SWSSomeIpXf00060 dThe BOM shall be added by the SOMEIP sending trans former implementation cSRSXfrm00101 72441 Strings fixed length The length of the string this includes the 0 in Bytes is specified in the data type definition SWSSomeIpXf00240 Recognition of UTF8 Fixed Length Strings dAn UTF8 Fixed Length String shall be detected if an ApplicationPrimitiveDataType and anImplementationDataType with the following pattern are used ApplicationPrimitiveDataType withcategory equal to STRING ApplicationPrimitiveDataType swDataDefProps swTextProps baseType refers to a BaseType withbaseTypeDefinition baseType Encoding equal to UTF8 ImplementationDataType withcategory ARRAY that contains exactly one ImplementationDataTypeElement that boils down to a uint8 ImplementationDataType ImplementationDataTypeElement arraySize is set to a value ImplementationDataTypeElement arraySizeSemantics is set tofixedSize cSRSXfrm00101 SWSSomeIpXf00241 Recognition of UTF16 Fixed Length Strings dAn UTF16 Fixed Length String shall be detected if an ApplicationPrimitiveDataType and anImplementationDataType with the following pattern are used ApplicationPrimitiveDataType withcategory equal to STRING 40 of 107 Document ID 660 AUTOSARSWSSOMEIPTransformerSpecification of SOMEIP Transformer AUTOSAR CP R2111 ApplicationPrimitiveDataType swDataDefProps swTextProps baseType refers to a BaseType withbaseTypeDefinition baseType Encoding equal to UTF16 ImplementationDataType withcategory ARRAY that contains exactly one ImplementationDataTypeElement that boils down to a uint16 ImplementationDataType ImplementationDataTypeElement arraySize is set to a value ImplementationDataTypeElement arraySizeSemantics is set tofixedSize cSRSXfrm00101 SWSSomeIpXf00244 Serialization of fixed length strings dSerialization of fixed length strings shall consist of the following steps 1 Check whether the string terminates with 0x00 UTF8 or 0x0000 UTF16 If not a ESERGENERICERROR error shall be issued 2 Appending BOM at the beginning of the output buffer if BOM is not already avail able in the first three UTF8 or two UTF16 bytes of the to be serialized array containing the string If the BOM is already present simply copy the BOM into the output buffer 3 Copying the string data the number of bytes according to the strings fixed length from the array into the output buffer optionally performing a conversion between UTF16LE and UTF16BE between ECU and network byte order if BaseTypeDi rectDefinition byteOrder andSOMEIPTransformationDescription byteOrder have different values cSRSXfrm00101 SWSSomeIpXf00246 Deserialization of fixed length strings dDeserialization of fixed length strings shall consist of the following steps 1 Check whether the string starts with a BOM If not a MALFORMEDMESSAGE error shall be issued 2 Check whether BOM has the same value as SOMEIPTransformationDe scription byteOrder If not a MALFORMEDMESSAGE error shall be issued 3 Remove the BOM 4 Silently discard the last byte of the string in case of an UTF16 string with odd length 5 Check whether the string terminates with 0x00 UTF8 or 0x0000 UTF16 If not a MALFORMEDMESSAGE error shall be issued 41 of 107 Document ID 660 AUTOSARSWSSOMEIPTransformerSpecification of SOMEIP Transformer AUTOSAR CP R2111 6 Copy the string data the number of bytes according to the strings fixed length from the input buffer into the array optionally performing a conversion between UTF16LE and UTF16BE between network and ECU byte order if BaseTypeDi rectDefinition byteOrder andSOMEIPTransformationDescription byteOrder have different values cSRSXfrm00101 72442 Strings dynamic length Strings with dynamic length can be realized in an AUTOSAR system as an array with dynamic length that transports the single characters SWSSomeIpXf00242 Recognition of UTF8 Variable Length Strings dAn UTF8 Fixed Length String shall be detected if an ApplicationPrimitiveDataType and anImplementationDataType with the following pattern are used ApplicationPrimitiveDataType withcategory equal to STRING ApplicationPrimitiveDataType swDataDefProps swTextProps baseType refers to a BaseType withbaseTypeDefinition baseType Encoding equal to UTF8 ImplementationDataType TheImplementationDataType shall be defined according to TPSSWCT 01650 as a STRUCTURE that contains exactly two Implementation DataTypeElement s and shall follow the rules defined by constr1318 oneImplementationDataTypeElement represents the Size Indica tor and has the category equal to TYPEREFERENCE which points to a uint8 uint16 or uint32 ImplementationDataType oneImplementationDataTypeElement has the category equal to ARRAY and contains exactly one ImplementationDataTypeElement that boils down to a uint8 ImplementationDataType cSRSXfrm00101 SWSSomeIpXf00243 Recognition of UTF16 Variable Length Strings dAn UTF16 Fixed Length String shall be detected if an ApplicationPrimitive DataType and an ImplementationDataType with the following pattern are used ApplicationPrimitiveDataType withcategory equal to