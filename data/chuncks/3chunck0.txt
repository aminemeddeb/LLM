1 Protecting In Vehicle Services SecurityEnabled SOMEIP Middleware Marco Iorio Alberto Buttiglieriy Massimo Reineriy Fulvio Risso Riccardo Sisto Fulvio Valenza Politecnico di Torino Torino Italy namesurnamepolitoit yItaldesign Moncalieri Italy namesurnameitaldesignit Abstract With every generation vehicles are becoming smarter and more oriented toward information and communi cations technology ICT However computerization is posing unforeseen challenges in a sector for which the rst goal must be safety car hacking has been shown to be a real threat This article presents a novel mechanism to provide improved security for applications executed in the vehicle based on the principle of dening exactly who can talk to whom The proposed security framework targets Ethernetbased communications and is tightly integrated within the emerging Scalable serviceOriented Middle warE over IP SOMEIP middleware No complex congurations are needed simple highlevel rules clearly stating the commu nications allowed are the only element required to enable the security features The designed solution has been implemented as a proof of concept PoC inside the vsomeip stack to evaluate the validity of the approach proposed experimental measurements conrm that the additional overhead introduced in endtoend communication is negligible I B ACKGROUND Modern cars are characterized by dozens of different Electronic Control Units ECUs each one hosting one or more applications devoted to monitor and manage every single aspect of the vehicle itself Advanced Driving Assistance Systems are going further moving the control of safety critical systems like braking and steering to computers algorithms and software Different devices cannot operate in complete isolation communications and protocols are fundamental to allow the ex change of information within the car To this extent Controller Area Network CAN bus is a wellestablished technology forming the backbone of every invehicle network being it suitable for strongly realtime oriented applications By its side Automotive Ethernet 1 is gaining more and more importance enabling highbandwidth communications and replacing a plethora of complex proprietary technologies 2 On the top of bare Ethernet Service Oriented Architectures SOAs are becoming increasingly popular as a highlevel abstraction to support complex applications and allow for maximum exibility 3 According to this design pattern a system is composed of a set of services providing different functionalities Additionally the communication is abstracted through a virtual bus allowing the exchange of messages regardless of the physical device where each service is currently executed on To date one of the most promising SOA middleware for invehicle communications is SOMEIP 4 having it beendesigned explicitly for automotive usecases by the AUTOSAR consortium With the increasing prominence of computerbased systems new challenges are threatening the life of millions of unaware drivers During recent years different researchers have suc ceeded in exploiting specically crafted network messages to take over the control of safetycritical systems 5 6 Albeit the presented attacks do require physical access to invehicle buses isolation cannot be assumed as a sufcient prevention On the one hand 7 8 demonstrated that many commercial vehicles present serious vulnerabilities in network stack implementations namely Bluetooth WiFi and 4G granting wicked individuals the possibility to remotely access the cars internals On the other one possible attacks may originate from within the vehicle itself both unauthorized devices and compromised software updates could be installed by dishonest mechanics or for tuning reasons Being a vital system in every vehicle the CAN bus has already been the subject of extensive research to increase the security and prevent malicious attacks Groza et al 9 recently presented a survey of a wide range of possible solutions including both active protections which exploit cryptographic functions to guarantee message authentication and physical layer solutions using signal patterns to distinguish between different nodes On the other hand much less attention has been devoted to the protection of Ethernetbased communications in the automotive domain Although effective and mature protocol suites are available in the broader eld of ICT networking they appear not to t well the peculiarities of invehicle networks and especially of the SOMEIP middleware The IPsec protocol for example is restricted by limited granularity due to application unawareness while TLS does not support multicast communications and requires a rather complex authentication handshake Hamad et al 10 recently proposed a framework to provide secure communications between ECUs by exploiting security policies However this solution requires the denition of lowlevel rules strongly limiting the dynamism introduced by SOAs This paper presents a novel security framework protecting SOMEIPbased communications It has been designed with simplicity in mind leveraging the integration within the communication middleware to replace lowlevel policies with simple highlevel rules clearly stating the permitted trafc matrix in terms of services Along with the denition of2 the allowed communications the proposed solution grants application developers the capability of assigning a different security level to each service Thus the protection can be tuned depending on the specic level of criticality to achieve the best tradeoff between security and performance II SOMEIP SOMEIP is an emerging communication middleware stan dardized by AUTOSAR It aims to include all the features required by automotive Ethernetoriented usecases while fullling the hard requirements regarding resource consumption in vehicles The middleware is designed to provide a service oriented abstraction on the top of one or more transport protocols mainly UDP and TCP and offers two communi cation patterns requestresponse and publishsubscribe The former corresponds to standard Remote Procedure Call RPC providing the possibility to invoke functions made available by other applications The latter on the other hand exploits notications managed directly by the middleware to decouple the sender from the recipients and allow for trafc optimization Additionally one of the most noteworthy features provided by SOMEIP is the service discovery 11 which can dynamically advertise the availability of different services as well as manage the subscription to selected events However albeit being deemed to be very promising as a communication middleware SOMEIP does not include any security functionality leaving the applications and the messages transmitted across the network completely unprotected from malicious attacks A vsomeip Thevsomeip stack1is an opensource implementation of the SOMEIP specications designed as part of the GENIVI project A representation of the architecture proposed by vsomeip is depicted in Fig 1 which shows two ECUs interconnected through an Ethernet