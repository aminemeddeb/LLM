data As for the former we congured the payload to contain the maximum possible amount of data 1400 bytes considering the SOMEIP limitations Messages transported over TCP on the other hand were characterized by 64 kB payloads To better assess the actual throughput we also relaxed the limitation regarding the network speed Hence during this benchmark the two ECUs were effectively interconnected at 1 Gbps Fig 5c presents the outcome of the evaluation measuring both the ability of the sender to transmit the messages and 00204Thr Gbps AES128CCM AES256CCM AES128GCM AES256GCM ChaCha20Poly1305 Authentication Condentiality0204060 Security levelCPU Fig 6 Throughput over TCP and CPU usage comparison between different symmetric cryptography algorithms adopted to secure SOMEIP messages the capacity of the receiver to consume them ie including the necessary authentication and decryption operations Along with the other values the iperf3 bar represents a reference measurement obtained using the wellknown tool It aims to measure the bare network performance on top of UDP and TCP sockets in case the SOMEIP abstraction was not adopted At a glance it clearly stands out the signicantly better performance associated with iperf3 compared to vsomeip Indeed in case UDP is adopted the former achieved a throughput almost four times higher while comparably loading the CPU Conversely with regards to the TCP benchmark similar throughput values were obtained yet a fourfold drop in CPU usage was observed when using iperf3 This comparison points out the high overhead introduced by the vsomeip implementation Hence it clearly remains a signicant room for improvements which security features would undoubtedly also benet from In this respect focusing on the UDP benchmark authentication andcondentiality levels respectively introduced an additional slow down accounting for 15 and 25 When adopting TCP as a transport protocol on the other hand condentiality impacted signicantly on the effective throughput being responsible for a 50 drop in performance compared to vanilla vsomeip Finally Fig 6 compares the throughput values achieved when adopting different stateoftheart authenticated encryption algorithms In detail the evaluations were carried out over TCP operating the cryptographic algorithms both in authentication only and AEAD mode ie condentiality level ChaCha20 Poly1305 clearly emerged as the fastest alternative Indeed although offering a 256 bits security level it achieved twice as much throughput compared to the second namely AESGCM AESCCM on the other hand appeared to be the slowest14 01020Txtorx delay msVanilla Nosec Authentication Condentiality 2 4 8 12 16020406080 Simulated camerasCPU Fig 7 Performance comparison between vanilla vsomeip and our security enhanced version in terms of txtorx delay and CPU usage when simulating multiple cameras operating at 60 fps and generating compressed video frames of425 kB 43 in case of remote communication the dotted line represents a reference corresponding to a delay equal to 16 ms especially concerning authentication level services As for the AES security level about a 20 additional overhead was introduced when moving from 128 bits to256 bits keys F Realistic Scenario The previous benchmarks were meant to independently measure the different facets of the overhead introduced by the runtime protection Yet to generalize the overall evaluation and assess the actual effects in a broader and more realistic scenario we then focused on simulating an ADAS system Specically we simulated multiple cameras in parallel each one operating at 60 fps and generating compressed video frames of425 kB 21 Mbps per camera 43 All frames were generated and timestamped by the rst board and sent to the second one over a 1 Gbps link and adopting TCP as a transport protocol to evaluate the txtorx delay and the CPU usage when varying the number of cameras and increasing the security level To this end we set 16 ms as an upper bound for the delay to guarantee the reception of a frame before the generation of the subsequent Yet stricter requirements may need to be enforced depending on the specic application and the amount of processing to be performed on the data received Finally as for clock synchronization we leveraged the Precision Time Protocol which delivers submicrosecond accuracy on LANs 44 Fig 7 summarizes the results of the evaluation considering the number of parallel cameras ranging from 242 Mbps to16336 Mbps Concerning the txtorx delay the box plot represents the extension of the quartiles as well as of the 1stand the 99thpercentile a representative set of outliers is shown as individual points for 100 s long simulations Focusing rst on the reference scenarios ie those with no security features enabled the median delay remained conned in the 253 ms range Yet an increase in the number of cameras corresponded to a higher dispersion as well as a proportional growth in CPU usage The introduction of authentication level security caused a 1525 additional overhead with a more signicant increase for what regards the 99thpercentile mark Nonetheless all frames but a very few outliers required less than 10 ms to be correctly received and authenticated 02040Thr MBsSW i SW ii HW i HW ii 64 256 1 k 4 k 16 k 64 k02040 Chunk size bytes CPU Fig 8 Performance comparison between software and hardware implementa tions of AES128CBC when encrypting multiple chunks of data within i the same and ii different cryptographic contexts hence completely satisfying the requirements previously set Conversely condentiality was associated with a considerably higher impact both in terms of delay median and 99th percentile as well as CPU usage Additionally as for the most demanding case a few frames failed to be delivered within the expected deadline We believe the outcome of this benchmark to be twofold One the one hand it showed the sustainability of the security features having the requirements been satised in all but the most demanding scenario On the other hand it uncovered the much higher overhead associated with condentiality compared to authentication only Hence requiring a careful analysis to assess whether for each service this additional protection is actually required to avoid introducing unnecessary overhead Nonetheless it is also fair to mention that the ECUs leveraged for infotainment and ADAS systems on modern vehicles are much more powerful than our testbed eg the NVIDIA Drive PX family features up to 16ARM cores